<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>19×19 Map Game – Teleport Tiles</title>
  <style>
    :root{
      --dark-grey:#6b7280;
      --dark-yellow:#a39e5f; /* accent */
      --gunmetal:#6f818f;
      --reddish-grey:#a46b6b;
      --blueish-grey:#6b7ca4;
      --purplish-grey:#8c6ba4;
      --dark-sky:#5bc0eb;
      --floor-grey:#383d42;
      --kitchen-green:#6ba46b;
      --bg:#0e0e0e;
      --ink:#e8e6df;
      --accent: var(--dark-yellow);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{ margin:0; background:var(--bg); color:var(--ink); font:16px/1.4 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:24px; padding:16px; }

    /* Board */
    #grid{ --size:19; display:grid; grid-template-columns:repeat(var(--size), 1em); grid-auto-rows:1em; font-size:clamp(14px, min(3vw, 3vh), 22px); line-height:1; user-select:none; border:1px dashed var(--accent); border-radius:14px; background:#111; padding:5px; gap:0; width:fit-content; }
    #grid span{ width:1em; height:1em; display:inline-grid; place-items:center; }
    .player{ color:var(--dark-sky); font-weight:700; }
    .floor{ color:var(--dark-grey); }
    .wall{ color:var(--gunmetal); }
    .treasure{ color:var(--dark-yellow); }
    .teleport{ color:var(--kitchen-green); }
    .sign{ color:var(--reddish-grey); }

    /* Controls */
    .controls{ width:min(800px, 96vw); display:flex; gap:50px; justify-content:center; align-items:flex-start; }
    .dpad{ display:grid; grid-template-areas: ". up ." "left down right"; gap:12px; }
    .btn{ width:64px; height:64px; display:grid; place-items:center; background:#151515; color:var(--accent); border:1px dashed var(--accent); border-radius:10px; font-weight:600; user-select:none; cursor:pointer; }
    .btn:active{ transform:translateY(1px); }
    .btn.up{ grid-area:up } .btn.down{ grid-area:down } .btn.left{ grid-area:left } .btn.right{ grid-area:right } .btn.center{ grid-area:center }
    .ab{ display:flex; flex-direction:column; gap:16px; }

    /* Focus/tap cleanup */
    :where(button){ outline:none; }
    :where(button):focus-visible{ outline:2px dashed var(--accent); outline-offset:3px; }
    *{ -webkit-tap-highlight-color: transparent; }
  </style>
</head>
<body>
  <div id="grid" aria-label="Game grid" role="grid"></div>

  <div class="controls">
    <div class="dpad" aria-label="Directional pad">
      <button class="btn up"    data-dir="up">↑</button>
      <button class="btn left"  data-dir="left">←</button>
      <button class="btn right" data-dir="right">→</button>
      <button class="btn down"  data-dir="down">↓</button>
    </div>
    <div class="ab" aria-label="A and B buttons">
      <button class="btn" id="btnA">A</button>
      <button class="btn" id="btnB">B</button>
    </div>
  </div>

  <script>
    /* ===== Dense-map with teleport pairs ===== */
    const SIZE = 19;

    // Two rooms: add '▦' where you want a teleporter entrance/exit
    const mapA = [
      "▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.........@.......▦",
      "▣.................▣",
      "▣.................▣",
      "▣.........#.......▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣",
    ];

    const mapB = [
      "▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▦.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣.................▣",
      "▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣▣",
    ];

    const maps = [mapA, mapB];

    // Teleport registry: from (map,x,y) -> (map,x,y)
    // Example: T1A in map 0 at (6,7) -> T1B in map 1 at (6,10)
    const TELEPORTS = new Map();
    function tpKey(m,x,y){ return `${m}:${x},${y}`; }
    function addTeleport(fromM, fromX, fromY, toM, toX, toY){
      TELEPORTS.set(tpKey(fromM,fromX,fromY), {m:toM, x:toX, y:toY});
    }
    // compute coordinates of the '▦' we placed above
    addTeleport(0, 18, 10, 1, 0, 10); // T1A -> T1B
    addTeleport(1, 0, 10, 0, 18, 10);  // T1B -> T1A (return)

    let currentMap = 0;
    const player = {x:9, y:10};

    const grid = document.getElementById('grid');

    function draw(){
      grid.innerHTML = '';
      for(let y=0;y<SIZE;y++){
        for(let x=0;x<SIZE;x++){
          const span = document.createElement('span');
          const ch = maps[currentMap][y][x];
          if(player.x===x && player.y===y){ span.textContent='@'; span.className='player'; }
          else if(ch==='▣'){ span.textContent='▣'; span.className='wall'; }
          else if(ch==='▦'){ span.textContent='▦'; span.className='teleport'; }
          else { span.textContent='□'; span.className='floor'; }
          grid.appendChild(span);
        }
      }
    }

    function passable(m,x,y){
        const ch = maps[m][y][x]; return ch !== '▣'; }

    function maybeTeleport(){
      const dest = TELEPORTS.get(tpKey(currentMap, player.x, player.y));
      if(dest){ currentMap = dest.m; player.x = dest.x; player.y = dest.y; draw(); }
    }

    function move(dx,dy){
      const nx = player.x + dx, ny = player.y + dy;
      if(nx<0||ny<0||nx>=SIZE||ny>=SIZE) return;
      if(!passable(currentMap,nx,ny)) return;
      player.x = nx; player.y = ny;
      draw();
      maybeTeleport();
    }

    // Keyboard
    document.addEventListener('keydown', e=>{
      if(e.key==='ArrowUp' || e.key==='w') move(0,-1);
      if(e.key==='ArrowDown' || e.key==='s') move(0, 1);
      if(e.key==='ArrowLeft' || e.key==='a') move(-1,0);
      if(e.key==='ArrowRight' || e.key==='d') move(1, 0);
    });

    // On-screen controls
    document.querySelectorAll('[data-dir]').forEach(btn=>{
      const dir = btn.dataset.dir;
      const act = dir==='up'?()=>move(0,-1):dir==='down'?()=>move(0,1):dir==='left'?()=>move(-1,0):dir==='right'?()=>move(1,0):()=>{};
      btn.addEventListener('click', act);
    });

    // A/B placeholders
    document.getElementById('btnA').addEventListener('click', ()=>{});
    document.getElementById('btnB').addEventListener('click', ()=>{});

    draw();
  </script>
</body>
</html>
